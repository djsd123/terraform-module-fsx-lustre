{
  "format_version": "1.1",
  "terraform_version": "1.2.7",
  "variables": {
    "name": {
      "value": "fsx-test"
    }
  },
  "planned_values": {
    "root_module": {
      "child_modules": [
        {
          "resources": [
            {
              "address": "module.fsx_lustre_monitoring.aws_cloudwatch_dashboard.fsx_filesystem_dashboard[0]",
              "mode": "managed",
              "type": "aws_cloudwatch_dashboard",
              "name": "fsx_filesystem_dashboard",
              "index": 0,
              "provider_name": "registry.terraform.io/hashicorp/aws",
              "schema_version": 0,
              "values": {
                "dashboard_name": "fsx-test-mon-eu-west-1"
              },
              "sensitive_values": {}
            },
            {
              "address": "module.fsx_lustre_monitoring.aws_cloudwatch_metric_alarm.fsx_storage_capacity_alarm[0]",
              "mode": "managed",
              "type": "aws_cloudwatch_metric_alarm",
              "name": "fsx_storage_capacity_alarm",
              "index": 0,
              "provider_name": "registry.terraform.io/hashicorp/aws",
              "schema_version": 1,
              "values": {
                "actions_enabled": true,
                "comparison_operator": "LessThanThreshold",
                "datapoints_to_alarm": null,
                "evaluation_periods": 1,
                "extended_statistic": null,
                "insufficient_data_actions": null,
                "metric_name": "FreeDataStorageCapacity",
                "metric_query": [],
                "namespace": "AWS/FSx",
                "ok_actions": null,
                "period": 60,
                "statistic": "Sum",
                "tags": null,
                "tags_all": {
                  "Repo": "terraform-module-fsx-lustre",
                  "Terraform": "true"
                },
                "threshold": 7100000000000,
                "threshold_metric_id": null,
                "treat_missing_data": "missing",
                "unit": null
              },
              "sensitive_values": {
                "alarm_actions": [],
                "dimensions": {},
                "metric_query": [],
                "tags_all": {}
              }
            },
            {
              "address": "module.fsx_lustre_monitoring.aws_fsx_lustre_file_system.fsx_filesystem",
              "mode": "managed",
              "type": "aws_fsx_lustre_file_system",
              "name": "fsx_filesystem",
              "provider_name": "registry.terraform.io/hashicorp/aws",
              "schema_version": 0,
              "values": {
                "backup_id": "",
                "copy_tags_to_backups": false,
                "data_compression_type": "NONE",
                "deployment_type": "SCRATCH_2",
                "drive_cache_type": null,
                "file_system_type_version": "2.12",
                "import_path": "s3://nasanex",
                "per_unit_storage_throughput": null,
                "security_group_ids": [
                  "sg-01234567890abcdefg"
                ],
                "storage_capacity": 7200,
                "storage_type": "SSD",
                "subnet_ids": [
                  "subnet-01234567890abcdefg"
                ],
                "tags": {
                  "Name": "fsx-test-mon"
                },
                "tags_all": {
                  "Name": "fsx-test-mon",
                  "Repo": "terraform-module-fsx-lustre",
                  "Terraform": "true"
                },
                "timeouts": null
              },
              "sensitive_values": {
                "log_configuration": [],
                "network_interface_ids": [],
                "security_group_ids": [
                  false
                ],
                "subnet_ids": [
                  false
                ],
                "tags": {},
                "tags_all": {}
              }
            },
            {
              "address": "module.fsx_lustre_monitoring.aws_sns_topic.alarm_notification[0]",
              "mode": "managed",
              "type": "aws_sns_topic",
              "name": "alarm_notification",
              "index": 0,
              "provider_name": "registry.terraform.io/hashicorp/aws",
              "schema_version": 0,
              "values": {
                "application_failure_feedback_role_arn": null,
                "application_success_feedback_role_arn": null,
                "application_success_feedback_sample_rate": null,
                "content_based_deduplication": false,
                "delivery_policy": null,
                "fifo_topic": false,
                "firehose_failure_feedback_role_arn": null,
                "firehose_success_feedback_role_arn": null,
                "firehose_success_feedback_sample_rate": null,
                "http_failure_feedback_role_arn": null,
                "http_success_feedback_role_arn": null,
                "http_success_feedback_sample_rate": null,
                "kms_master_key_id": null,
                "lambda_failure_feedback_role_arn": null,
                "lambda_success_feedback_role_arn": null,
                "lambda_success_feedback_sample_rate": null,
                "sqs_failure_feedback_role_arn": null,
                "sqs_success_feedback_role_arn": null,
                "sqs_success_feedback_sample_rate": null,
                "tags": null,
                "tags_all": {
                  "Repo": "terraform-module-fsx-lustre",
                  "Terraform": "true"
                }
              },
              "sensitive_values": {
                "tags_all": {}
              }
            },
            {
              "address": "module.fsx_lustre_monitoring.aws_sns_topic_subscription.alarm_email_subscription[0]",
              "mode": "managed",
              "type": "aws_sns_topic_subscription",
              "name": "alarm_email_subscription",
              "index": 0,
              "provider_name": "registry.terraform.io/hashicorp/aws",
              "schema_version": 0,
              "values": {
                "confirmation_timeout_in_minutes": 1,
                "delivery_policy": null,
                "endpoint": "liz.bot@hustings.wem",
                "endpoint_auto_confirms": false,
                "filter_policy": null,
                "protocol": "email",
                "raw_message_delivery": false,
                "redrive_policy": null,
                "subscription_role_arn": null
              },
              "sensitive_values": {}
            }
          ],
          "address": "module.fsx_lustre_monitoring"
        },
        {
          "resources": [
            {
              "address": "module.fsx_lustre_no_monitoring.aws_fsx_lustre_file_system.fsx_filesystem",
              "mode": "managed",
              "type": "aws_fsx_lustre_file_system",
              "name": "fsx_filesystem",
              "provider_name": "registry.terraform.io/hashicorp/aws",
              "schema_version": 0,
              "values": {
                "backup_id": "",
                "copy_tags_to_backups": false,
                "data_compression_type": "NONE",
                "deployment_type": "SCRATCH_2",
                "drive_cache_type": null,
                "file_system_type_version": "2.12",
                "import_path": "s3://nasanex",
                "per_unit_storage_throughput": null,
                "security_group_ids": [
                  "sg-01234567890abcdefg"
                ],
                "storage_capacity": 7200,
                "storage_type": "SSD",
                "subnet_ids": [
                  "subnet-01234567890abcdefg"
                ],
                "tags": {
                  "Name": "fsx-test-nomon"
                },
                "tags_all": {
                  "Name": "fsx-test-nomon",
                  "Repo": "terraform-module-fsx-lustre",
                  "Terraform": "true"
                },
                "timeouts": null
              },
              "sensitive_values": {
                "log_configuration": [],
                "network_interface_ids": [],
                "security_group_ids": [
                  false
                ],
                "subnet_ids": [
                  false
                ],
                "tags": {},
                "tags_all": {}
              }
            }
          ],
          "address": "module.fsx_lustre_no_monitoring"
        }
      ]
    }
  },
  "resource_changes": [
    {
      "address": "module.fsx_lustre_monitoring.aws_cloudwatch_dashboard.fsx_filesystem_dashboard[0]",
      "module_address": "module.fsx_lustre_monitoring",
      "mode": "managed",
      "type": "aws_cloudwatch_dashboard",
      "name": "fsx_filesystem_dashboard",
      "index": 0,
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "change": {
        "actions": [
          "create"
        ],
        "before": null,
        "after": {
          "dashboard_name": "fsx-test-mon-eu-west-1"
        },
        "after_unknown": {
          "dashboard_arn": true,
          "dashboard_body": true,
          "id": true
        },
        "before_sensitive": false,
        "after_sensitive": {}
      }
    },
    {
      "address": "module.fsx_lustre_monitoring.aws_cloudwatch_metric_alarm.fsx_storage_capacity_alarm[0]",
      "module_address": "module.fsx_lustre_monitoring",
      "mode": "managed",
      "type": "aws_cloudwatch_metric_alarm",
      "name": "fsx_storage_capacity_alarm",
      "index": 0,
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "change": {
        "actions": [
          "create"
        ],
        "before": null,
        "after": {
          "actions_enabled": true,
          "comparison_operator": "LessThanThreshold",
          "datapoints_to_alarm": null,
          "evaluation_periods": 1,
          "extended_statistic": null,
          "insufficient_data_actions": null,
          "metric_name": "FreeDataStorageCapacity",
          "metric_query": [],
          "namespace": "AWS/FSx",
          "ok_actions": null,
          "period": 60,
          "statistic": "Sum",
          "tags": null,
          "tags_all": {
            "Repo": "terraform-module-fsx-lustre",
            "Terraform": "true"
          },
          "threshold": 7100000000000,
          "threshold_metric_id": null,
          "treat_missing_data": "missing",
          "unit": null
        },
        "after_unknown": {
          "alarm_actions": true,
          "alarm_description": true,
          "alarm_name": true,
          "arn": true,
          "dimensions": true,
          "evaluate_low_sample_count_percentiles": true,
          "id": true,
          "metric_query": [],
          "tags_all": {}
        },
        "before_sensitive": false,
        "after_sensitive": {
          "alarm_actions": [],
          "dimensions": {},
          "metric_query": [],
          "tags_all": {}
        }
      }
    },
    {
      "address": "module.fsx_lustre_monitoring.aws_fsx_lustre_file_system.fsx_filesystem",
      "module_address": "module.fsx_lustre_monitoring",
      "mode": "managed",
      "type": "aws_fsx_lustre_file_system",
      "name": "fsx_filesystem",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "change": {
        "actions": [
          "create"
        ],
        "before": null,
        "after": {
          "backup_id": "",
          "copy_tags_to_backups": false,
          "data_compression_type": "NONE",
          "deployment_type": "SCRATCH_2",
          "drive_cache_type": null,
          "file_system_type_version": "2.12",
          "import_path": "s3://nasanex",
          "per_unit_storage_throughput": null,
          "security_group_ids": [
            "sg-01234567890abcdefg"
          ],
          "storage_capacity": 7200,
          "storage_type": "SSD",
          "subnet_ids": [
            "subnet-01234567890abcdefg"
          ],
          "tags": {
            "Name": "fsx-test-mon"
          },
          "tags_all": {
            "Name": "fsx-test-mon",
            "Repo": "terraform-module-fsx-lustre",
            "Terraform": "true"
          },
          "timeouts": null
        },
        "after_unknown": {
          "arn": true,
          "auto_import_policy": true,
          "automatic_backup_retention_days": true,
          "daily_automatic_backup_start_time": true,
          "dns_name": true,
          "export_path": true,
          "id": true,
          "imported_file_chunk_size": true,
          "kms_key_id": true,
          "log_configuration": true,
          "mount_name": true,
          "network_interface_ids": true,
          "owner_id": true,
          "security_group_ids": [
            false
          ],
          "subnet_ids": [
            false
          ],
          "tags": {},
          "tags_all": {},
          "vpc_id": true,
          "weekly_maintenance_start_time": true
        },
        "before_sensitive": false,
        "after_sensitive": {
          "log_configuration": [],
          "network_interface_ids": [],
          "security_group_ids": [
            false
          ],
          "subnet_ids": [
            false
          ],
          "tags": {},
          "tags_all": {}
        }
      }
    },
    {
      "address": "module.fsx_lustre_monitoring.aws_sns_topic.alarm_notification[0]",
      "module_address": "module.fsx_lustre_monitoring",
      "mode": "managed",
      "type": "aws_sns_topic",
      "name": "alarm_notification",
      "index": 0,
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "change": {
        "actions": [
          "create"
        ],
        "before": null,
        "after": {
          "application_failure_feedback_role_arn": null,
          "application_success_feedback_role_arn": null,
          "application_success_feedback_sample_rate": null,
          "content_based_deduplication": false,
          "delivery_policy": null,
          "fifo_topic": false,
          "firehose_failure_feedback_role_arn": null,
          "firehose_success_feedback_role_arn": null,
          "firehose_success_feedback_sample_rate": null,
          "http_failure_feedback_role_arn": null,
          "http_success_feedback_role_arn": null,
          "http_success_feedback_sample_rate": null,
          "kms_master_key_id": null,
          "lambda_failure_feedback_role_arn": null,
          "lambda_success_feedback_role_arn": null,
          "lambda_success_feedback_sample_rate": null,
          "sqs_failure_feedback_role_arn": null,
          "sqs_success_feedback_role_arn": null,
          "sqs_success_feedback_sample_rate": null,
          "tags": null,
          "tags_all": {
            "Repo": "terraform-module-fsx-lustre",
            "Terraform": "true"
          }
        },
        "after_unknown": {
          "arn": true,
          "display_name": true,
          "id": true,
          "name": true,
          "name_prefix": true,
          "owner": true,
          "policy": true,
          "tags_all": {}
        },
        "before_sensitive": false,
        "after_sensitive": {
          "tags_all": {}
        }
      }
    },
    {
      "address": "module.fsx_lustre_monitoring.aws_sns_topic_subscription.alarm_email_subscription[0]",
      "module_address": "module.fsx_lustre_monitoring",
      "mode": "managed",
      "type": "aws_sns_topic_subscription",
      "name": "alarm_email_subscription",
      "index": 0,
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "change": {
        "actions": [
          "create"
        ],
        "before": null,
        "after": {
          "confirmation_timeout_in_minutes": 1,
          "delivery_policy": null,
          "endpoint": "liz.bot@hustings.wem",
          "endpoint_auto_confirms": false,
          "filter_policy": null,
          "protocol": "email",
          "raw_message_delivery": false,
          "redrive_policy": null,
          "subscription_role_arn": null
        },
        "after_unknown": {
          "arn": true,
          "confirmation_was_authenticated": true,
          "id": true,
          "owner_id": true,
          "pending_confirmation": true,
          "topic_arn": true
        },
        "before_sensitive": false,
        "after_sensitive": {}
      }
    },
    {
      "address": "module.fsx_lustre_no_monitoring.aws_fsx_lustre_file_system.fsx_filesystem",
      "module_address": "module.fsx_lustre_no_monitoring",
      "mode": "managed",
      "type": "aws_fsx_lustre_file_system",
      "name": "fsx_filesystem",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "change": {
        "actions": [
          "create"
        ],
        "before": null,
        "after": {
          "backup_id": "",
          "copy_tags_to_backups": false,
          "data_compression_type": "NONE",
          "deployment_type": "SCRATCH_2",
          "drive_cache_type": null,
          "file_system_type_version": "2.12",
          "import_path": "s3://nasanex",
          "per_unit_storage_throughput": null,
          "security_group_ids": [
            "sg-01234567890abcdefg"
          ],
          "storage_capacity": 7200,
          "storage_type": "SSD",
          "subnet_ids": [
            "subnet-01234567890abcdefg"
          ],
          "tags": {
            "Name": "fsx-test-nomon"
          },
          "tags_all": {
            "Name": "fsx-test-nomon",
            "Repo": "terraform-module-fsx-lustre",
            "Terraform": "true"
          },
          "timeouts": null
        },
        "after_unknown": {
          "arn": true,
          "auto_import_policy": true,
          "automatic_backup_retention_days": true,
          "daily_automatic_backup_start_time": true,
          "dns_name": true,
          "export_path": true,
          "id": true,
          "imported_file_chunk_size": true,
          "kms_key_id": true,
          "log_configuration": true,
          "mount_name": true,
          "network_interface_ids": true,
          "owner_id": true,
          "security_group_ids": [
            false
          ],
          "subnet_ids": [
            false
          ],
          "tags": {},
          "tags_all": {},
          "vpc_id": true,
          "weekly_maintenance_start_time": true
        },
        "before_sensitive": false,
        "after_sensitive": {
          "log_configuration": [],
          "network_interface_ids": [],
          "security_group_ids": [
            false
          ],
          "subnet_ids": [
            false
          ],
          "tags": {},
          "tags_all": {}
        }
      }
    }
  ],
  "configuration": {
    "provider_config": {
      "module.fsx_lustre_monitoring:aws": {
        "name": "aws",
        "full_name": "registry.terraform.io/hashicorp/aws",
        "version_constraint": "~> 4.0",
        "module_address": "module.fsx_lustre_monitoring",
        "expressions": {
          "default_tags": [
            {
              "tags": {
                "constant_value": {
                  "Repo": "terraform-module-fsx-lustre",
                  "Terraform": true
                }
              }
            }
          ],
          "region": {
            "constant_value": "eu-west-1"
          }
        }
      },
      "module.fsx_lustre_monitoring:cloudinit": {
        "name": "cloudinit",
        "full_name": "registry.terraform.io/hashicorp/cloudinit",
        "version_constraint": "~> 2.2",
        "module_address": "module.fsx_lustre_monitoring"
      },
      "module.fsx_lustre_no_monitoring:aws": {
        "name": "aws",
        "full_name": "registry.terraform.io/hashicorp/aws",
        "version_constraint": "~> 4.0",
        "module_address": "module.fsx_lustre_no_monitoring",
        "expressions": {
          "default_tags": [
            {
              "tags": {
                "constant_value": {
                  "Repo": "terraform-module-fsx-lustre",
                  "Terraform": true
                }
              }
            }
          ],
          "region": {
            "constant_value": "eu-west-1"
          }
        }
      },
      "module.fsx_lustre_no_monitoring:cloudinit": {
        "name": "cloudinit",
        "full_name": "registry.terraform.io/hashicorp/cloudinit",
        "version_constraint": "~> 2.2",
        "module_address": "module.fsx_lustre_no_monitoring"
      }
    },
    "root_module": {
      "module_calls": {
        "fsx_lustre_monitoring": {
          "source": "../",
          "expressions": {
            "alarm_notification_email_address": {
              "constant_value": "liz.bot@hustings.wem"
            },
            "enable_low_storage_capacity_monitoring": {
              "constant_value": true
            },
            "name": {
              "references": [
                "var.name"
              ]
            },
            "region": {
              "constant_value": "eu-west-1"
            },
            "security_group_ids": {
              "constant_value": [
                "sg-01234567890abcdefg"
              ]
            },
            "storage_capacity": {
              "constant_value": 7200
            },
            "subnet_id": {
              "constant_value": "subnet-01234567890abcdefg"
            }
          },
          "module": {
            "resources": [
              {
                "address": "aws_cloudwatch_dashboard.fsx_filesystem_dashboard",
                "mode": "managed",
                "type": "aws_cloudwatch_dashboard",
                "name": "fsx_filesystem_dashboard",
                "provider_config_key": "module.fsx_lustre_monitoring:aws",
                "expressions": {
                  "dashboard_body": {
                    "references": [
                      "path.module",
                      "aws_cloudwatch_metric_alarm.fsx_storage_capacity_alarm",
                      "count.index",
                      "aws_fsx_lustre_file_system.fsx_filesystem.id",
                      "aws_fsx_lustre_file_system.fsx_filesystem",
                      "var.name",
                      "var.region"
                    ]
                  },
                  "dashboard_name": {
                    "references": [
                      "var.name",
                      "var.region"
                    ]
                  }
                },
                "schema_version": 0,
                "count_expression": {
                  "references": [
                    "var.enable_low_storage_capacity_monitoring"
                  ]
                }
              },
              {
                "address": "aws_cloudwatch_metric_alarm.fsx_storage_capacity_alarm",
                "mode": "managed",
                "type": "aws_cloudwatch_metric_alarm",
                "name": "fsx_storage_capacity_alarm",
                "provider_config_key": "module.fsx_lustre_monitoring:aws",
                "expressions": {
                  "alarm_actions": {
                    "references": [
                      "aws_sns_topic.alarm_notification",
                      "count.index"
                    ]
                  },
                  "alarm_description": {
                    "references": [
                      "aws_fsx_lustre_file_system.fsx_filesystem.id",
                      "aws_fsx_lustre_file_system.fsx_filesystem"
                    ]
                  },
                  "alarm_name": {
                    "references": [
                      "aws_fsx_lustre_file_system.fsx_filesystem.id",
                      "aws_fsx_lustre_file_system.fsx_filesystem"
                    ]
                  },
                  "comparison_operator": {
                    "constant_value": "LessThanThreshold"
                  },
                  "dimensions": {
                    "references": [
                      "aws_fsx_lustre_file_system.fsx_filesystem.arn",
                      "aws_fsx_lustre_file_system.fsx_filesystem"
                    ]
                  },
                  "evaluation_periods": {
                    "constant_value": 1
                  },
                  "metric_name": {
                    "constant_value": "FreeDataStorageCapacity"
                  },
                  "namespace": {
                    "constant_value": "AWS/FSx"
                  },
                  "period": {
                    "constant_value": 60
                  },
                  "statistic": {
                    "constant_value": "Sum"
                  },
                  "threshold": {
                    "references": [
                      "var.low_free_data_storage_capacity_threshold"
                    ]
                  },
                  "treat_missing_data": {
                    "constant_value": "missing"
                  }
                },
                "schema_version": 1,
                "count_expression": {
                  "references": [
                    "var.enable_low_storage_capacity_monitoring"
                  ]
                }
              },
              {
                "address": "aws_fsx_lustre_file_system.fsx_filesystem",
                "mode": "managed",
                "type": "aws_fsx_lustre_file_system",
                "name": "fsx_filesystem",
                "provider_config_key": "module.fsx_lustre_monitoring:aws",
                "expressions": {
                  "backup_id": {
                    "references": [
                      "var.backup_id"
                    ]
                  },
                  "data_compression_type": {
                    "references": [
                      "var.data_compression_type"
                    ]
                  },
                  "deployment_type": {
                    "references": [
                      "var.deployment_type"
                    ]
                  },
                  "file_system_type_version": {
                    "references": [
                      "var.file_system_type_version"
                    ]
                  },
                  "import_path": {
                    "references": [
                      "var.s3_import_path"
                    ]
                  },
                  "security_group_ids": {
                    "references": [
                      "var.security_group_ids"
                    ]
                  },
                  "storage_capacity": {
                    "references": [
                      "var.storage_capacity"
                    ]
                  },
                  "storage_type": {
                    "references": [
                      "var.storage_type"
                    ]
                  },
                  "subnet_ids": {
                    "references": [
                      "var.subnet_id"
                    ]
                  },
                  "tags": {
                    "references": [
                      "var.name"
                    ]
                  }
                },
                "schema_version": 0
              },
              {
                "address": "aws_sns_topic.alarm_notification",
                "mode": "managed",
                "type": "aws_sns_topic",
                "name": "alarm_notification",
                "provider_config_key": "module.fsx_lustre_monitoring:aws",
                "expressions": {
                  "display_name": {
                    "references": [
                      "aws_fsx_lustre_file_system.fsx_filesystem.id",
                      "aws_fsx_lustre_file_system.fsx_filesystem"
                    ]
                  },
                  "name": {
                    "references": [
                      "aws_fsx_lustre_file_system.fsx_filesystem.id",
                      "aws_fsx_lustre_file_system.fsx_filesystem"
                    ]
                  }
                },
                "schema_version": 0,
                "count_expression": {
                  "references": [
                    "var.enable_low_storage_capacity_monitoring"
                  ]
                }
              },
              {
                "address": "aws_sns_topic_subscription.alarm_email_subscription",
                "mode": "managed",
                "type": "aws_sns_topic_subscription",
                "name": "alarm_email_subscription",
                "provider_config_key": "module.fsx_lustre_monitoring:aws",
                "expressions": {
                  "endpoint": {
                    "references": [
                      "var.alarm_notification_email_address"
                    ]
                  },
                  "protocol": {
                    "constant_value": "email"
                  },
                  "topic_arn": {
                    "references": [
                      "aws_sns_topic.alarm_notification"
                    ]
                  }
                },
                "schema_version": 0,
                "count_expression": {
                  "references": [
                    "var.enable_low_storage_capacity_monitoring"
                  ]
                }
              }
            ],
            "variables": {
              "alarm_notification_email_address": {
                "description": "The email address to send FSX storage alarms/alerts to"
              },
              "backup_id": {
                "default": "",
                "description": "The ID of the source backup to create the filesystem from."
              },
              "data_compression_type": {
                "default": "NONE",
                "description": "The data compression configuration for the file system. Valid values are 'LZ4' and 'NONE'"
              },
              "deployment_type": {
                "default": "SCRATCH_2",
                "description": "The filesystem deployment type. One of: SCRATCH_1, SCRATCH_2, PERSISTENT_1, PERSISTENT_2."
              },
              "enable_low_storage_capacity_monitoring": {
                "default": false,
                "description": "Whether to enable the dashboard and 'Low free storage capacity alarm'?"
              },
              "file_system_type_version": {
                "default": 2.12,
                "description": "The Lustre version for the file system."
              },
              "low_free_data_storage_capacity_threshold": {
                "default": "7100000000000",
                "description": "Low free data storage capacity threshold (Bytes)"
              },
              "name": {
                "description": "Common name for all resources"
              },
              "region": {
                "description": "The region to deploy the resources"
              },
              "s3_import_path": {
                "default": "s3://nasanex",
                "description": "The s3 bucket to use to back your fsx filesystem. Defaults to NASA's Nex open data bucket"
              },
              "security_group_ids": {
                "description": "A list of security group Ids to apply to the filesystem."
              },
              "storage_capacity": {
                "description": "Storage capacity of file system. See: https://docs.aws.amazon.com/fsx/latest/APIReference/API_CreateFileSystem.html#FSx-CreateFileSystem-request-StorageCapacity"
              },
              "storage_type": {
                "default": "SSD",
                "description": "The filesystem storage type. Either SSD or HDD."
              },
              "subnet_id": {
                "description": "The subnet to create the filesystem in.  Note; FSx Lustre only supports one 'availability zone/subnet'"
              }
            }
          }
        },
        "fsx_lustre_no_monitoring": {
          "source": "../",
          "expressions": {
            "alarm_notification_email_address": {
              "constant_value": "liz.bot@hustings.wem"
            },
            "enable_low_storage_capacity_monitoring": {
              "constant_value": false
            },
            "name": {
              "references": [
                "var.name"
              ]
            },
            "region": {
              "constant_value": "eu-west-1"
            },
            "security_group_ids": {
              "constant_value": [
                "sg-01234567890abcdefg"
              ]
            },
            "storage_capacity": {
              "constant_value": 7200
            },
            "subnet_id": {
              "constant_value": "subnet-01234567890abcdefg"
            }
          },
          "module": {
            "resources": [
              {
                "address": "aws_cloudwatch_dashboard.fsx_filesystem_dashboard",
                "mode": "managed",
                "type": "aws_cloudwatch_dashboard",
                "name": "fsx_filesystem_dashboard",
                "provider_config_key": "module.fsx_lustre_no_monitoring:aws",
                "expressions": {
                  "dashboard_body": {
                    "references": [
                      "path.module",
                      "aws_cloudwatch_metric_alarm.fsx_storage_capacity_alarm",
                      "count.index",
                      "aws_fsx_lustre_file_system.fsx_filesystem.id",
                      "aws_fsx_lustre_file_system.fsx_filesystem",
                      "var.name",
                      "var.region"
                    ]
                  },
                  "dashboard_name": {
                    "references": [
                      "var.name",
                      "var.region"
                    ]
                  }
                },
                "schema_version": 0,
                "count_expression": {
                  "references": [
                    "var.enable_low_storage_capacity_monitoring"
                  ]
                }
              },
              {
                "address": "aws_cloudwatch_metric_alarm.fsx_storage_capacity_alarm",
                "mode": "managed",
                "type": "aws_cloudwatch_metric_alarm",
                "name": "fsx_storage_capacity_alarm",
                "provider_config_key": "module.fsx_lustre_no_monitoring:aws",
                "expressions": {
                  "alarm_actions": {
                    "references": [
                      "aws_sns_topic.alarm_notification",
                      "count.index"
                    ]
                  },
                  "alarm_description": {
                    "references": [
                      "aws_fsx_lustre_file_system.fsx_filesystem.id",
                      "aws_fsx_lustre_file_system.fsx_filesystem"
                    ]
                  },
                  "alarm_name": {
                    "references": [
                      "aws_fsx_lustre_file_system.fsx_filesystem.id",
                      "aws_fsx_lustre_file_system.fsx_filesystem"
                    ]
                  },
                  "comparison_operator": {
                    "constant_value": "LessThanThreshold"
                  },
                  "dimensions": {
                    "references": [
                      "aws_fsx_lustre_file_system.fsx_filesystem.arn",
                      "aws_fsx_lustre_file_system.fsx_filesystem"
                    ]
                  },
                  "evaluation_periods": {
                    "constant_value": 1
                  },
                  "metric_name": {
                    "constant_value": "FreeDataStorageCapacity"
                  },
                  "namespace": {
                    "constant_value": "AWS/FSx"
                  },
                  "period": {
                    "constant_value": 60
                  },
                  "statistic": {
                    "constant_value": "Sum"
                  },
                  "threshold": {
                    "references": [
                      "var.low_free_data_storage_capacity_threshold"
                    ]
                  },
                  "treat_missing_data": {
                    "constant_value": "missing"
                  }
                },
                "schema_version": 1,
                "count_expression": {
                  "references": [
                    "var.enable_low_storage_capacity_monitoring"
                  ]
                }
              },
              {
                "address": "aws_fsx_lustre_file_system.fsx_filesystem",
                "mode": "managed",
                "type": "aws_fsx_lustre_file_system",
                "name": "fsx_filesystem",
                "provider_config_key": "module.fsx_lustre_no_monitoring:aws",
                "expressions": {
                  "backup_id": {
                    "references": [
                      "var.backup_id"
                    ]
                  },
                  "data_compression_type": {
                    "references": [
                      "var.data_compression_type"
                    ]
                  },
                  "deployment_type": {
                    "references": [
                      "var.deployment_type"
                    ]
                  },
                  "file_system_type_version": {
                    "references": [
                      "var.file_system_type_version"
                    ]
                  },
                  "import_path": {
                    "references": [
                      "var.s3_import_path"
                    ]
                  },
                  "security_group_ids": {
                    "references": [
                      "var.security_group_ids"
                    ]
                  },
                  "storage_capacity": {
                    "references": [
                      "var.storage_capacity"
                    ]
                  },
                  "storage_type": {
                    "references": [
                      "var.storage_type"
                    ]
                  },
                  "subnet_ids": {
                    "references": [
                      "var.subnet_id"
                    ]
                  },
                  "tags": {
                    "references": [
                      "var.name"
                    ]
                  }
                },
                "schema_version": 0
              },
              {
                "address": "aws_sns_topic.alarm_notification",
                "mode": "managed",
                "type": "aws_sns_topic",
                "name": "alarm_notification",
                "provider_config_key": "module.fsx_lustre_no_monitoring:aws",
                "expressions": {
                  "display_name": {
                    "references": [
                      "aws_fsx_lustre_file_system.fsx_filesystem.id",
                      "aws_fsx_lustre_file_system.fsx_filesystem"
                    ]
                  },
                  "name": {
                    "references": [
                      "aws_fsx_lustre_file_system.fsx_filesystem.id",
                      "aws_fsx_lustre_file_system.fsx_filesystem"
                    ]
                  }
                },
                "schema_version": 0,
                "count_expression": {
                  "references": [
                    "var.enable_low_storage_capacity_monitoring"
                  ]
                }
              },
              {
                "address": "aws_sns_topic_subscription.alarm_email_subscription",
                "mode": "managed",
                "type": "aws_sns_topic_subscription",
                "name": "alarm_email_subscription",
                "provider_config_key": "module.fsx_lustre_no_monitoring:aws",
                "expressions": {
                  "endpoint": {
                    "references": [
                      "var.alarm_notification_email_address"
                    ]
                  },
                  "protocol": {
                    "constant_value": "email"
                  },
                  "topic_arn": {
                    "references": [
                      "aws_sns_topic.alarm_notification"
                    ]
                  }
                },
                "schema_version": 0,
                "count_expression": {
                  "references": [
                    "var.enable_low_storage_capacity_monitoring"
                  ]
                }
              }
            ],
            "variables": {
              "alarm_notification_email_address": {
                "description": "The email address to send FSX storage alarms/alerts to"
              },
              "backup_id": {
                "default": "",
                "description": "The ID of the source backup to create the filesystem from."
              },
              "data_compression_type": {
                "default": "NONE",
                "description": "The data compression configuration for the file system. Valid values are 'LZ4' and 'NONE'"
              },
              "deployment_type": {
                "default": "SCRATCH_2",
                "description": "The filesystem deployment type. One of: SCRATCH_1, SCRATCH_2, PERSISTENT_1, PERSISTENT_2."
              },
              "enable_low_storage_capacity_monitoring": {
                "default": false,
                "description": "Whether to enable the dashboard and 'Low free storage capacity alarm'?"
              },
              "file_system_type_version": {
                "default": 2.12,
                "description": "The Lustre version for the file system."
              },
              "low_free_data_storage_capacity_threshold": {
                "default": "7100000000000",
                "description": "Low free data storage capacity threshold (Bytes)"
              },
              "name": {
                "description": "Common name for all resources"
              },
              "region": {
                "description": "The region to deploy the resources"
              },
              "s3_import_path": {
                "default": "s3://nasanex",
                "description": "The s3 bucket to use to back your fsx filesystem. Defaults to NASA's Nex open data bucket"
              },
              "security_group_ids": {
                "description": "A list of security group Ids to apply to the filesystem."
              },
              "storage_capacity": {
                "description": "Storage capacity of file system. See: https://docs.aws.amazon.com/fsx/latest/APIReference/API_CreateFileSystem.html#FSx-CreateFileSystem-request-StorageCapacity"
              },
              "storage_type": {
                "default": "SSD",
                "description": "The filesystem storage type. Either SSD or HDD."
              },
              "subnet_id": {
                "description": "The subnet to create the filesystem in.  Note; FSx Lustre only supports one 'availability zone/subnet'"
              }
            }
          }
        }
      },
      "variables": {
        "name": {
          "default": "fsx-test"
        }
      }
    }
  },
  "relevant_attributes": [
    {
      "resource": "module.fsx_lustre_monitoring.aws_fsx_lustre_file_system.fsx_filesystem",
      "attribute": [
        "id"
      ]
    },
    {
      "resource": "module.fsx_lustre_monitoring.aws_sns_topic.alarm_notification",
      "attribute": []
    },
    {
      "resource": "module.fsx_lustre_monitoring.aws_fsx_lustre_file_system.fsx_filesystem",
      "attribute": [
        "arn"
      ]
    },
    {
      "resource": "module.fsx_lustre_monitoring.aws_cloudwatch_metric_alarm.fsx_storage_capacity_alarm",
      "attribute": []
    }
  ]
}
